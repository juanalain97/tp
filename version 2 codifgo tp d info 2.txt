#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

// Definición de estados
typedef enum {
    DISPONIBLE,
    NO_DISPONIBLE
} EstadoBanco;

EstadoBanco estadoDisponible(int contadorPersonas);
EstadoBanco estadoNoDisponible(int contadorPersonas);
void leerSensor();

// Funciones de estado
EstadoBanco estadoDisponible(int contadorPersonas) {
    printf("El banco está disponible. Personas: %d\n", contadorPersonas);
    leerSensor();
    
    if (contadorPersonas >= 30) {
        return NO_DISPONIBLE;
    } else {
        return DISPONIBLE;
    }
}

EstadoBanco estadoNoDisponible(int contadorPersonas) {
    printf("El banco no está disponible. Personas: %d\n", contadorPersonas);
    leerSensor();
    
    if (contadorPersonas < 30) {
        return DISPONIBLE;
    } else {
        return NO_DISPONIBLE;
    }
}

// Función para simular la lectura del sensor
void leerSensor() {
    // Simulación de lectura de sensor
    
    printf("Leyendo sensor...\n");
}

int main() {
    int contadorPersonas = 0;
    EstadoBanco estadoActual = DISPONIBLE;

    // Definición del vector de punteros a funciones
    EstadoBanco (*funcionesEstado[])(int) = {estadoDisponible, estadoNoDisponible};

    printf("Bienvenido al banco\n");

    while (1) {
        // Llamada a la función de estado actual
        estadoActual = funcionesEstado[estadoActual](contadorPersonas);

        // Simulo la entrada/salida de personas
        char accion;
        printf("¿Entra (I) o sale (S) una persona? (Presione 'Q' para salir): ");
        scanf(" %c", &accion);

        if (accion == 'Q' || accion == 'q') {
            break;
        } else if (accion == 'I' || accion == 'i') {
            if (contadorPersonas < 30) {
                contadorPersonas++;
            } else {
                printf("El banco está lleno, no se pueden agregar más personas.\n");
            }
        } else if (accion == 'S' || accion == 's') {
            if (contadorPersonas > 0) {
                contadorPersonas--;
            } else {
                printf("No hay personas en el banco para salir.\n");
            }
        }
    }

    printf("Gracias por visitar el banco. Hasta luego!\n");

    return 0;
}
